<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ğŸ™ é£Ÿäº‹ã®è¨˜éŒ²</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <base target="_top"> <style>
    body {
      font-family: sans-serif;
      font-size: 26px; /* medicine.htmlã«åˆã‚ã›ã‚‹ */
      padding: 1.5em 0.5em 1.5em 0.5em; /* medicine.htmlã«åˆã‚ã›ã‚‹ */
      background: #fff;
      color: #000; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ–‡å­—è‰² */
      text-align: left;
      line-height: 1.5; /* è¡Œé–“ã®èª¿æ•´ */
    }
    h1 {
      font-size: 32px; /* medicine.htmlã«åˆã‚ã›ã‚‹ */
      margin: 0.2em 0 0.4em; /* medicine.htmlã«åˆã‚ã›ã‚‹ */
    }
    .section {
      margin-bottom: 1.5em; /* medicine.htmlã«åˆã‚ã›ã‚‹ */
    }
    /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹/ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .checkbox-grid, .radio-group {
      display: grid;
      grid-template-columns: 1fr 1fr; /* 2åˆ—ã§å‡ç­‰å¹… */
      gap: 1em; /* medicine.htmlã®radio-gridã«åˆã‚ã›ã‚‹ */
    }
    /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹/ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
    .checkbox-grid label,
    .radio-group label {
      display: flex; /* Flexboxã§å†…å®¹ã‚’ä¸­å¤®æƒãˆ */
      align-items: center;
      justify-content: center; /* æ°´å¹³æ–¹å‘ä¸­å¤® */
      text-align: center; /* ãƒ†ã‚­ã‚¹ãƒˆã‚‚ä¸­å¤®æƒãˆ */
      border: 2px solid #888;
      border-radius: 10px;
      padding: 0.8em 1.5em; /* medicine.htmlã®ãƒ©ãƒ™ãƒ«ã¨ä¸€è‡´ */
      background: #f0f0f0;
      cursor: pointer;
      font-size: 26px; /* medicine.htmlã®ãƒ©ãƒ™ãƒ«ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã¨ä¸€è‡´ (pxã§æŒ‡å®š) */
      box-sizing: border-box; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚„ãƒœãƒ¼ãƒ€ãƒ¼ã‚’å«ã‚ã¦å¹…ã‚’è¨ˆç®— */
      white-space: nowrap; /* ãƒ©ãƒ™ãƒ«å†…ã®æ–‡å­—ãŒæ”¹è¡Œã•ã‚Œãªã„ã‚ˆã†ã« */
      transition: background-color 0.2s, border-color 0.2s, color 0.2s; /* ãƒ›ãƒãƒ¼/é¸æŠæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    }
    /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹/ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³æœ¬ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .checkbox-grid input[type="checkbox"],
    .radio-group input[type="radio"] {
      transform: scale(1.6); /* medicine.htmlã® transform: scale(1.6) ã‚’ç¶­æŒ */
      margin-right: 0.6em; /* medicine.htmlã® margin-right ã‚’ç¶­æŒ */
      flex-shrink: 0; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒç¸®ã¾ãªã„ã‚ˆã†ã« */
    }
    /* é¸æŠã•ã‚ŒãŸéš›ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .checkbox-grid input[type="checkbox"]:checked + label,
    .radio-group input[type="radio"]:checked + label {
      background: #007BFF;
      color: white;
      border-color: #0056b3;
    }

    /* ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã¨ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›æ¬„ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    textarea, input[type="text"] {
      width: 100%;
      font-size: 24px; /* medicine.htmlã®.dateè¦ç´ ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã«åˆã‚ã›ã‚‹ */
      padding: 0.8em; /* medicine.htmlã®ãƒ©ãƒ™ãƒ«ã¨åŒã˜ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã§çµ±ä¸€æ„Ÿã‚’å‡ºã™ */
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    textarea {
      height: 6em; /* ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®é«˜ã•ã€‚medicine.htmlã®textareaã®é«˜ã•ã«è¿‘ã¥ã‘ã‚‹ */
      resize: vertical; /* ç¸¦æ–¹å‘ã®ã¿ãƒªã‚µã‚¤ã‚ºå¯èƒ½ */
    }
    input[type="text"][name="side"] { /* ãŠã‹ãšå…¥åŠ›æ¬„ã®é«˜ã•èª¿æ•´ */
      height: auto; /* è‡ªå‹•èª¿æ•´ */
      min-height: 2.5em; /* æœ€å°é«˜ã• */
    }

    /* ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« (medicine.htmlã‚’å‚è€ƒã«æ‹¡å¤§) */
    .send-btn, .back-btn {
      display: block; /* ãƒ–ãƒ­ãƒƒã‚¯è¦ç´  */
      font-size: 28px; /* medicine.htmlã®ãƒœã‚¿ãƒ³ã®æ¨å®šã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦èª¿æ•´ */
      border-radius: 10px; /* medicine.htmlã¨ä¸€è‡´ */
      padding: 1.2em 2em; /* medicine.htmlã®ãƒœã‚¿ãƒ³ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å‚è€ƒã«èª¿æ•´ */
      cursor: pointer;
      box-sizing: border-box;
      white-space: nowrap; /* ãƒ†ã‚­ã‚¹ãƒˆã®æ”¹è¡Œã‚’é˜²ã */
      text-align: center; /* ãƒ†ã‚­ã‚¹ãƒˆä¸­å¤®å¯„ã› */
      width: 100%; /* è¦ªè¦ç´ ã®å¹…ã«åˆã‚ã›ã¦100%ã«åºƒã’ã‚‹ */
      max-width: 700px; /* medicine.htmlã®ãƒœã‚¿ãƒ³ã®å¹…ã«è¿‘ã¥ã‘ã‚‹ */
      transition: background-color 0.2s, border-color 0.2s, color 0.2s; /* ãƒ›ãƒãƒ¼æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    }
    .send-btn {
      background-color: #add8e6; /* medicine.htmlã®èƒŒæ™¯è‰² */
      color: #000; /* medicine.htmlã®æ–‡å­—è‰² */
      border: 3px solid #007BFF; /* medicine.htmlã®ãƒœãƒ¼ãƒ€ãƒ¼ */
    }
    .send-btn:hover {
        background-color: #9ac0d6; /* ãƒ›ãƒãƒ¼æ™‚ã®è‰² */
    }
    .back-btn {
      background-color: #eeeeee; /* medicine.htmlã®èƒŒæ™¯è‰² */
      color: #333; /* medicine.htmlã®æ–‡å­—è‰² */
      border: 2px solid #999; /* medicine.htmlã®ãƒœãƒ¼ãƒ€ãƒ¼ */
    }
    .back-btn:hover {
        background-color: #dddddd; /* ãƒ›ãƒãƒ¼æ™‚ã®è‰² */
    }
    /* ãƒœã‚¿ãƒ³ã‚’ç¸¦ã«ä¸¦ã¹ã€ä¸­å¤®ã«é…ç½®ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠ */
    .button-row {
      display: flex;
      flex-direction: column; /* ç¸¦ä¸¦ã³ */
      gap: 1.2em; /* medicine.htmlã«åˆã‚ã›ã‚‹ */
      align-items: center; /* Flexã‚¢ã‚¤ãƒ†ãƒ ï¼ˆãƒœã‚¿ãƒ³ï¼‰ã‚’ä¸»è»¸ï¼ˆã“ã®å ´åˆæ¨ªæ–¹å‘ï¼‰ã§ä¸­å¤®æƒãˆ */
      margin-top: 2em; /* ä¸Šéƒ¨ã®ä½™ç™½ */
      width: 100%; /* è¦ªè¦ç´ ã®å¹…ã‚’æ˜ç¤ºçš„ã«100%ã«ã™ã‚‹ */
    }

    #historyLink {
      position: fixed;
      bottom: 0.6rem;
      right: 0.8rem;
      font-size: 0.8rem;
      opacity: 0.6;
      color: #111;
      text-decoration: none;
    }
    .sub {
      font-size: 0.7em;
      color: #555;
      margin-bottom: 0.3em;
    }

    /* ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®ã‚¹ã‚¿ã‚¤ãƒ« (medicine.htmlã®ã‚‚ã®ã‚’æµç”¨) */
    #successPopup, #errorPopup {
        position:fixed; 
        top: 45%; 
        left:50%; 
        transform:translate(-50%, -50%);
        background: white; 
        border: 4px solid #007BFF; 
        border-radius: 16px; 
        padding: 1.5em 2em; 
        z-index: 9999;
        font-size: 2.5rem; 
        text-align: center; 
        box-shadow: 0 0 10px rgba(0,0,0,0.3);
        white-space: nowrap; 
    }
    #errorPopup {
        border: 2px solid red;
        color: red;
        background: #fff8f8;
    }
  </style>
</head>
<body>
  <h1>ğŸ™ é£Ÿäº‹ã®è¨˜éŒ²</h1>
  <form id="mealForm">
    <div class="section">
      <strong>ä¸»é£Ÿã‚’é¸æŠï¼š</strong>
      <div class="checkbox-grid">
        <label><input type="checkbox" name="main" value="ã”ã¯ã‚“" />ã”ã¯ã‚“</label>
        <label><input type="checkbox" name="main" value="ãƒ‘ãƒ³" />ãƒ‘ãƒ³</label>
        <label><input type="checkbox" name="main" value="ã‚ã‚“" />ã‚ã‚“</label>
        <label><input type="checkbox" name="main" value="é­š" />é­š</label>
        <label><input type="checkbox" name="main" value="è‚‰" />è‚‰</label>
        <label><input type="checkbox" name="main" value="é‡èœ" />é‡èœ</label>
        <label><input type="checkbox" name="main" value="å¼å½“" />å¼å½“</label>
      </div>
    </div>

    <div class="section">
      <label>ğŸ± ãŠã‹ãš</label>
      <div class="sub">ï¼ˆä¾‹ï¼šãƒã‚­ãƒ³ã€ã‚µãƒ©ãƒ€ãªã©ï¼‰</div>
      <input type="text" name="side" placeholder="ä¾‹ï¼šãƒã‚­ãƒ³ã€ã‚µãƒ©ãƒ€" />
    </div>

    <div class="section">
      <strong>é‡ï¼š</strong>
      <div class="radio-group">
        <label><input type="radio" name="amount" value="å¤šã‚" />å¤šã‚</label>
        <label><input type="radio" name="amount" value="ãµã¤ã†" />ãµã¤ã†</label>
        <label><input type="radio" name="amount" value="å°‘ãªã‚" />å°‘ãªã‚</label>
      </div>
    </div>

    <div class="section">
      <label>ğŸ€ æ„Ÿæƒ³ãƒ»æ°—ã«ãªã‚‹ã“ã¨ï¼š</label>
      <div class="sub">ï¼ˆğŸ™ï¸ãƒã‚¤ã‚¯ã§ã‚‚æ›¸ã‘ã¾ã™ï¼‰</div>
      <textarea name="comment" rows="4" placeholder="ä¾‹ï¼šç¾å‘³ã—ã‹ã£ãŸã€é£Ÿã¹ã™ããŸ"></textarea>
    </div>

    <div class="button-row">
      <button type="button" class="send-btn" onclick="submitForm()">ğŸ‘† å ±å‘Šã™ã‚‹</button>
      <button type="button" class="back-btn" onclick="history.back()">â† æˆ»ã‚‹</button>
    </div>
  </form>

  <a id="historyLink" href="history.html">å±¥æ­´</a>

  <div id="successPopup" style="display:none;">â­• é€ä¿¡å®Œäº†ï¼</div>
  <div id="errorPopup" style="display:none;">âŒ ã„ãšã‚Œã‹1ã¤ã¯å…¥åŠ›ã—ã¦ãã ã•ã„</div>

  <script>
    // **é‡è¦: ã“ã“ã«GASãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«å–å¾—ã—ãŸã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„**
    // ä¾‹: const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbz_YOUR_WEB_APP_ID_HERE/exec";
    const GAS_WEB_APP_URL = "ã“ã“ã«GASã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã‚’è²¼ã‚Šä»˜ã‘"; // â˜…è¦ç·¨é›†

    async function submitForm() {
      const f = document.forms.mealForm;

      const main = [...f.main].filter(c => c.checked).map(c => c.value).join(',');
      const side = f.side.value.trim();
      const amount = f.amount.value || ""; 
      const comment = f.comment.value.trim();

      // å…¥åŠ›ãƒã‚§ãƒƒã‚¯
      if (!main && !side && !amount && !comment) {
        document.getElementById("errorPopup").style.display = "block";
        setTimeout(() => {
          document.getElementById("errorPopup").style.display = "none";
        }, 2000);
        return; 
      }

      const formData = {
        type: "meal", // GASå´ã§è­˜åˆ¥ã™ã‚‹ãŸã‚ã®ã‚¿ã‚¤ãƒ—
        values: [main, side, amount, comment]
      };

      try {
        const response = await fetch(GAS_WEB_APP_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            // GitHub Pagesã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰ã®ã¿è¨±å¯ã™ã‚‹å ´åˆ
            // 'Origin': 'https://[ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å].github.io' 
            // ï¼ˆãŸã ã—ã€GASå´ã§Access-Control-Allow-Origin: '*' ã‚’è¨­å®šã—ã¦ã„ã‚‹å ´åˆã¯ä¸è¦ï¼‰
          },
          body: JSON.stringify(formData)
        });

        if (!response.ok) {
          // HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ200ç•ªå°ä»¥å¤–ã®å ´åˆ
          const errorData = await response.json().catch(() => ({})); // JSONè§£æå¤±æ•—ã‚‚è€ƒæ…®
          throw new Error('ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼: ' + (errorData.message || response.statusText || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'));
        }

        const result = await response.json();
        if (result.status === "success") {
          document.getElementById("successPopup").style.display = "block";
          setTimeout(() => {
            document.getElementById("successPopup").style.display = "none";
            // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒªã‚»ãƒƒãƒˆ
            [...f.main].forEach(c => c.checked = false); 
            f.side.value = ""; 
            [...f.amount].forEach(r => r.checked = false); 
            f.comment.value = ""; 
          }, 2000); 
        } else {
          throw new Error('GASã‹ã‚‰ã®ã‚¨ãƒ©ãƒ¼: ' + (result.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'));
        }

      } catch (e) {
          console.error('é€ä¿¡ã‚¨ãƒ©ãƒ¼:', e);
          document.getElementById("errorPopup").textContent = "âŒ é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ: " + e.message;
          document.getElementById("errorPopup").style.display = "block";
          setTimeout(() => {
            document.getElementById("errorPopup").style.display = "none";
            document.getElementById("errorPopup").textContent = "âŒ ã„ãšã‚Œã‹1ã¤ã¯å…¥åŠ›ã—ã¦ãã ã•ã„"; // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…ƒã«æˆ»ã™
          }, 4000); // ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºæ™‚é–“ã‚’å°‘ã—é•·ãã™ã‚‹
      }
    }
  </script>
</body>
</html>
