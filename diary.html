
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>日記フォーム</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      liff.init({ liffId: "1657254156-85059NlX" })
        .then(() => {
          if (!liff.isLoggedIn()) {
            liff.login();
          }
        })
        .catch(err => {
          document.body.innerHTML = "<p>LIFFの初期化に失敗しました：" + err + "</p>";
        });
    });
  </script>
  <style>
    body {
      font-family: sans-serif;
      padding: 1em;
      background-color: #f9f9f9;
    }
    textarea {
      width: 100%;
      height: 150px;
      font-size: 1rem;
      padding: 0.5em;
      box-sizing: border-box;
    }
    button {
      margin-top: 1em;
      padding: 0.6em 1.5em;
      font-size: 1rem;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
    }
  </style>
</head>
<body style="font-size: 1.6rem; font-family: sans-serif; padding: 1em; text-align: left;">
  <h1>📝 日記フォーム</h1>
  <form>
    <label for="diary">🌱思いや出来事をご自由に（例：要望・相談もOK）</label><br/>
    <textarea style="width: 100%; font-size: 1.4rem; padding: 0.5em;" id="diary" name="diary" placeholder="今日はこんなことがありました…"></textarea>
    <div style="margin-top: 1em;">🎙️ マイクでも書けます</div>
    <button style="font-size: 1.4rem; padding: 0.6em 1.2em; margin-top: 1em; display: block; width: 100%;" type="button" onclick="showSuccess()">👆報告する</button>
<button style="font-size: 1.4rem; padding: 0.6em 1.2em; margin-top: 1em; display: block; width: 100%;" type="button" onclick="liff.closeWindow()">← 戻る</button>
  </form>

<div id="successPopup" style="display:none; position: fixed; top: 40%; left: 50%; transform: translate(-50%, -50%);
  background: white; border: 4px solid #007BFF; border-radius: 16px; padding: 1.5em 2em; z-index: 9999;
  font-size: 2.5rem; text-align: center; box-shadow: 0 0 10px rgba(0,0,0,0.3);">
  <span style="white-space: nowrap;">⭕ 送信完了！</span>
</div>
<div id="errorPopup" style="
  display: none;
  font-size: 2rem;
  color: red;
  background: #fff8f8;
  padding: 1em 2em;
  border-radius: 12px;
  border: 2px solid red;
  position: fixed;
  top: 48%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 9999;
  text-align: center;">
  ❌ 入力できていません
</div>


<script>
  function showSuccess() {
    const textarea = document.querySelector('textarea');
    let textEntered = textarea && textarea.value.trim().length > 0;

    if (!textEntered) {
      const errorPopup = document.getElementById('errorPopup');
      errorPopup.style.display = 'block';
      setTimeout(() => {
        errorPopup.style.display = 'none';
      }, 2000);
      return;
    }

    const popup = document.getElementById('successPopup');
    popup.style.display = 'block';
    setTimeout(() => {
      if (typeof liff !== "undefined" && liff.closeWindow) {
        liff.closeWindow();
      }
    }, 3000);
  }
</script>

</body>
</html>
